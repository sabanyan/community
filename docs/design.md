# サイト構成の設計

## <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> 目的

- 目的：OSS化にあたり情報提供が必要であるため、サイトを作成する
- 要件：コンテンツ作成と保守は、メンバによる共同作業が容易な構成を採用する


## <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> 前提


- 目的：オンラインサイトを公開する
- 手段：静的サイトジェネレータを活用し、作成と保守の効率を高める
    - 理由：サイト作成の負荷を、最小限にしたい
    - 理由：リポジトリでの一元化、版管理をしたい → テキストベースが適
- 手段：静的サイトホスティングサービスを活用し、公開する
    - 理由：GitHub pages、Netify など、無料公開が可能
- 選定：静的サイトジェネレータとして、MkDocs を採用する
    - 記述： Markdown
    - theme： Material for MkDocs
        - 理由： 機能豊富な reStructuredText は、学習コスト高い
        - 理由： reSTのテキストは、直感的に 書きにくく、読みにくい
        - 理由： reSTでは Sphinx が著名だが、Markdownに比べて流行っていない
    - 機能： Markdownでは不足する部分を拡張で補う
        - 断念： 自動番号付けによる相互参照は行わない
        - 断念： 索引は作成しない
        - 断念： PGソースコード、モジュールとで、自動リンクは作成しない
        - 拡張： 保守用意な形で、ページ間の 相互参照 を行う → 記述ルール設定
        - 拡張： ツールチップによる用語説明を行う



## <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> 構成

ナビゲーション機能：コンテンツ階層の表示方法
:   - ヘッダー表示：サイトのヘッダー上に、リンクボタンを表示
        - 左サイドバー表示の最上位階層が、ヘッダーに表示される
    - 左サイドバー表示：ファイル単位の階層
    - 右サイドバー表示：ファイル内のコンテンツ階層
    - 補足：左・右サイドバーを統合した表示も可能<

リンク機能：ファイル間、ファイル内階層のurl
:   - ファイルへは、該当ファイルからの相対パスでリンク可能：パス/ファイル名
    - ファイル内階層へは、パス/ファイル名/#xxx でリンク可能
        - 注意：xxx部分は、自動生成され、制御はできない
        - 注意：ファイル内の階層のタイトル修正で、urlも変更される
            - h2 or ## 以降のタイトル名から生成される
            - 日本語は無視、空白は一つの"_"に変換される
            - 上記ルールで同名の場合、連番が付与される

ルール：ナビゲーション
:   - ヘッダー表示する
        - 数を多くしないこと
        - 文字数を少なくすること
        - 設定は、mkdocs.yml内で、mdファイル単位の階層を記述する
        - ヘッダーの表示名は、mkdocs.yml で定義する（される）
    - 左サイドバー、右サイドバーは、統合して１つ表示する
    - ファイル単位の階層、ファイル内の階層を吟味する
    - ファイル内階層への参照リンクは、リンク切れ防止で、極力回避すること

ルール：コンテンツの＜修正＞
:   - 各.mdファイル内の階層は、以下とする
        - h1 or # ： 先頭に１つまで使用可能。 ページ領域のタイトルとなる
        - h2 or ##以降： 自由に使用可能
        - 注意： MkDocsの仕様上、h1 が複数あると、サイドバーに正しく表示されない

ルール：相互参照リンクの保守性確保
:   - 相対パス指定を使用する。MkDocsの機能で、該当 .mdファイルからの相対パスが使用可能
    - 絶対パス指定は禁止する
    - フォルダ階層は、追加のみ可とし、名前変更・移動・削除を禁止する

ルール：用語集によるツールチップ表示
:   - 背景：標準のMarkdownでは、.mdファイルをまたいだ用語定義ができない
    - 対処：MkDocsの拡張機能で、.mdファイルへの他ファイル挿入を行い、用語定義を共有する
    - 対処：用語説明は、共有利用する.mdファイルへ記述し、一元化する
    - ルール：略語定義（Abbreviations）は、個別の.mdファイル内に記述しない
    - ルール：各.mdファイル内で、一元化した用語定義ファイルを挿入する

ルール：図表データなどのファイルの配置
:   - 背景：図表の保守性のため、.mdファイルと参照ファイルの紐付けを、明瞭にしたい
    - ルール：.mdファイルからみて、参照ファイルの場所が、容易に特定可能にすること
    - ルール：図表作成用の元ファイルも、同じ枠組みで一元管理すること


## <i class="fa fa-arrow-circle-right" aria-hidden="true"></i> 物理的配置


```
|- mkdocs.yml
|- includes/
    |- glossary.md   ツールチップ表示ワードの定義 → 各.md 内で参照する
|- docs/
    |- stylesheets/
        |- custom.css   CSSのカスタマイズ設定
    |
    |- index.md         Topページ：ホーム
    |
    |- about.md         Topページ：活動の紹介
    |- license.md       Topページ：ライセンス
    |- releases.md      Topページ：リリースノート
    |- news.md          Topページ：ニュース
    |- referances.md    Topページ：技術情報
    |- downloads.md     Topページ：ダウンロード
    |- blog.md          Topページ：ブログ
    |
    |- about/
        |- xxx.xxx       参照ファイル
    |- license/
        |- xxx.xxx       参照ファイル
    |- releases/
        |- xxx.xxx       図表など
    |- news/
        |- xxx.xxx       図表など
    |- referances/
        |- xxx.md        仕様定義
        |- <.mdの名前>/
            |- xxx.png   図表などの参照ファイル
    |- downloads/
        |- xxx.md        ダウンロード
        |- <.mdの名前>/
            |- xxx.xxx   ダウンロードファイル
    |- blog/
        |- <採番>.md      ブログ記事
        |- <採番>/
            |- xxx.xxx   記事ごとの参照ファイル
        |
        |- shared/
            |- xxx.xxx   記事で共有の参照ファイル
    |
    |- guides/           各種ガイド書
        |- install.md
        |- admin.md
        |- user.md
        |- creator.md
        |- developer.md
        |- faq.md
        |
        |- install/
            |- xxx.png   図表などの参照ファイル
        |- admin/
            |- xxx.png   図表などの参照ファイル
        |- user/
            |- xxx.png   図表などの参照ファイル
        |- creator/
            |- xxx.png   図表などの参照ファイル
        |- developer/
            |- xxx.png   図表などの参照ファイル
        |- faq/
            |- xxx.png   図表などの参照ファイル
        |
        |- tutorials.md
        |- tutorials/
            |- xxx.md
            :
            |- <.mdの名前>/
                |- xxx.png   図表などの参照ファイル
        :
    |- commands/
        |- _common/       共通的な説明文書
            |- xxx.md
            :
        |- _shared/
            |- xxx.png   共有する図表など
        |
        | 【-- nysol mcmd --】
        |- mcat/
            |- mcal.md
               図、csv、フローなど、紐付け用ファイル
        |- mcal/
            |- mcal.mdd
        :
        | 【-- 追加コマンド --】
        |- extra_commands/
            |- groupby2/
                |- groupby2.md
                   図、csv、フローなど、紐付け用ファイル
            :
```


